version: '3.8'  # Docker Compose file format version

services:
  wordpress:  # WordPress service
    image: wordpress:latest
    ports:
      - "8080:80"  # Map port 80 of the container to port 8080 of the host
    environment:
      WORDPRESS_DB_HOST: db:3306  # Database host
      WORDPRESS_DB_USER: wordpress
      WORDPRESS_DB_PASSWORD: wordpress
      WORDPRESS_DB_NAME: wordpress
    depends_on:
      - db  # Ensures the db service starts first

  db:  # MySQL service
    image: mysql:5.7
    environment:
      MYSQL_ROOT_PASSWORD: rootpassword
      MYSQL_DATABASE: wordpress
      MYSQL_USER: wordpress
      MYSQL_PASSWORD: wordpress



PS C:\Users\Abhishek Bhan\OneDrive\Desktop\se_docker_compose> docker ps                       
CONTAINER ID   IMAGE              COMMAND                  CREATED         STATUS         PORTS                  NAMES
e66dbe085ff3   wordpress:latest   "docker-entrypoint.s…"   8 minutes ago   Up 8 minutes   0.0.0.0:8080->80/tcp   se_docker_compose-wordpress-1
ebefd838567d   mysql:5.7          "docker-entrypoint.s…"   8 minutes ago   Up 8 minutes   3306/tcp, 33060/tcp    se_docker_compose-db-1
PS C:\Users\Abhishek Bhan\OneDrive\Desktop\se_docker_compose> docker exec -it se_docker_compose-db-1 mysql -u wordpress -p
Enter password: 
ERROR 1045 (28000): Access denied for user 'wordpress'@'localhost' (using password: YES)
PS C:\Users\Abhishek Bhan\OneDrive\Desktop\se_docker_compose> docker exec -it se_docker_compose-db-1 mysql -u wordpress -p
Enter password: 
ERROR 1045 (28000): Access denied for user 'wordpress'@'localhost' (using password: YES)
PS C:\Users\Abhishek Bhan\OneDrive\Desktop\se_docker_compose> docker exec -it se_docker_compose-db-1 mysql -u wordpress -p
Enter password: 
ERROR 1045 (28000): Access denied for user 'wordpress'@'localhost' (using password: YES)
PS C:\Users\Abhishek Bhan\OneDrive\Desktop\se_docker_compose> docker exec -it se_docker_compose-db-1 mysql -u wordpress -p
Enter password: 
ERROR 1045 (28000): Access denied for user 'wordpress'@'localhost' (using password: YES)
PS C:\Users\Abhishek Bhan\OneDrive\Desktop\se_docker_compose> docker exec -it se_docker_compose-db-1 mysql -u wordpress -p
Enter password: 
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 26
Server version: 5.7.44 MySQL Community Server (GPL)

Copyright (c) 2000, 2023, Oracle and/or its affiliates.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

mysql> show databases;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| wordpress          |
+--------------------+
2 rows in set (0.01 sec)

mysql> CREATE table emp(
    -> eid int PRIMARY KEY,
    -> name varchar(100) not null
    -> );
ERROR 1046 (3D000): No database selected
mysql> use emp
ERROR 1044 (42000): Access denied for user 'wordpress'@'%' to database 'emp'
mysql> use wordpress
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Database changed
mysql> CREATE table emp( eid int PRIMARY KEY, name varchar(100) not null );
Query OK, 0 rows affected (0.07 sec)

mysql> select * from emp;
Empty set (0.00 sec)

mysql> insert into emp(eid,name) values(1,"Alex");
Query OK, 1 row affected (0.01 sec)

mysql> insert into emp(eid,name) values(1,"Alex");
ERROR 1062 (23000): Duplicate entry '1' for key 'PRIMARY'
mysql> insert into emp(eid,name) values(2,"Max");
Query OK, 1 row affected (0.02 sec)

mysql> select * from emp;
+-----+------+
| eid | name |
+-----+------+
|   1 | Alex |
|   2 | Max  |
+-----+------+
2 rows in set (0.00 sec)








version: '3.8'

services:
  nodeapp:
    image: node:20
    container_name: nodeapp
    working_dir: /app
    volumes:
      - ./app:/app
    command: sh -c "npm install && node index.js"
    ports:
      - "3000:3000"
    depends_on:
      - mongo

  mongo:
    image: mongo:7.0
    container_name: mongodb
    ports:
      - "27017:27017"
    environment:
      MONGO_INITDB_ROOT_USERNAME: root
      MONGO_INITDB_ROOT_PASSWORD: rootpassword



const express = require('express');
const mongoose = require('mongoose');

const app = express();
app.use(express.json());

// Connect to MongoDB
mongoose.connect('mongodb://root:rootpassword@mongo:27017/mydb?authSource=admin')
  .then(() => console.log('MongoDB connected'))
  .catch(err => console.error('MongoDB connection error:', err));

// Define a simple schema
const UserSchema = new mongoose.Schema({
  name: String,
  age: Number
});

const User = mongoose.model('User', UserSchema);

// Routes
app.get('/', (req, res) => {
  res.send('Node + MongoDB App Running!');
});

app.post('/users', async (req, res) => {
  const user = new User(req.body);
  await user.save();
  res.send(user);
});

app.get('/users', async (req, res) => {
  const users = await User.find();
  res.send(users);
});

// Start server
app.listen(3000, () => {
  console.log('Server running on port 3000');
});





{
  "name": "se_week_6_node_mongo",
  "version": "1.0.0",
  "main": "index.js",
  "scripts": {
    "test": "echo \"Error: no test specified\" && exit 1"
  },
  "keywords": [],
  "author": "",
  "license": "ISC",
  "description": "",
  "dependencies": {
    "express": "^5.1.0",
    "mongoose": "^9.0.0"
  }
}





pipeline {
    agent any

    tools {
        maven 'MAVEN_HOME'   // Make sure this name matches Jenkins global tool config
    }

    stages {

        stage('Git Repo & Clean') {
            steps {
                echo "Cloning repository..."

                bat '''
                rmdir /s /q webapp 2>nul || echo Directory not found
                git clone https://github.com/Abhishekgyara/SE_WEEK8_JENKINS_WEBAPP.git webapp
                '''
            }
        }

        stage('Install') {
            steps {
                bat 'mvn install -f webapp/pom.xml'
            }
        }

        stage('Test') {
            steps {
                bat 'mvn test -f webapp/pom.xml'
            }
        }

        stage('Package') {
            steps {
                bat 'mvn package -f webapp/pom.xml'
            }
        }
    }
}

